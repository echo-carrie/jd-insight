import{createRenderer as e,getRequestDependencies as t,getPreloadLinks as r,getPrefetchLinks as n}from"vue-bundle-renderer/runtime";import{c as o,a as s,g as a,e as i,f as d,h as l,i as u,j as c,k as p,u as h}from"../_/nitro.mjs";import{renderToString as f}from"vue/server-renderer";import{createHead as m,propsToString as y,renderSSRHead as g}from"unhead/server";import{stringify as b,uneval as _}from"devalue";import{walkResolver as w}from"unhead/utils";import{toValue as v,isRef as x,hasInjectionContext as C,inject as S,ref as j,watchEffect as T,getCurrentInstance as A,onBeforeUnmount as R,onDeactivated as k,onActivated as P}from"vue";import{DeprecationsPlugin as $,PromisesPlugin as H,TemplateParamsPlugin as L,AliasSortingPlugin as O}from"unhead/plugins";const VueResolver=(e,t)=>x(t)?v(t):t,U="usehead";function useHead(e,t={}){const r=t.head||function(){if(C()){const e=S(U);if(!e)throw new Error("useHead() was called without provide context, ensure you call it through the setup() function.");return e}throw new Error("useHead() was called without provide context, ensure you call it through the setup() function.")}();return r.ssr?r.push(e||{},t):function(e,t,r={}){const n=j(!1);let o;T(()=>{const s=n.value?{}:w(t,VueResolver);o?o.patch(s):o=e.push(s,r)});A()&&(R(()=>{o.dispose()}),k(()=>{n.value=!0}),P(()=>{n.value=!1}));return o}(r,e,t)}function createHead(e={}){const t=m({...e,propResolvers:[VueResolver]});return t.install=function(e){return{install(t){t.config.globalProperties.$unhead=e,t.config.globalProperties.$head=e,t.provide(U,e)}}.install}(t),t}const z={meta:[{charset:"utf-8"},{name:"viewport",content:"width=device-width, initial-scale=1"},{name:"description",content:"基于AI的产品经理岗位JD智能解析工具，帮助产品经理小白快速理解岗位核心能力要求、岗位条件需求和核心产出物。"}],link:[],style:[],script:[],noscript:[],title:"JD Insight - 产品经理岗位智能解析工具"},M={id:"teleports"},N=`<div${y({id:"__nuxt"})}>`,D="</div>",getClientManifest=()=>import("../build/client.manifest.mjs").then(e=>e.default||e).then(e=>"function"==typeof e?e():e),E=lazyCachedFunction(async()=>{const t=await getClientManifest();if(!t)throw new Error("client.manifest is not available");const r=await import("../build/server.mjs").then(e=>e.default||e);if(!r)throw new Error("Server bundle is not available");return e(r,{manifest:t,renderToString:async function(e,t){const r=await f(e,t);return N+r+D},buildAssetsURL:o})}),F=lazyCachedFunction(async()=>{const t=await getClientManifest(),r=await import("../virtual/_virtual_spa-template.mjs").then(e=>e.template).catch(()=>"").then(e=>N+e+D),n=e(()=>()=>{},{manifest:t,renderToString:()=>r,buildAssetsURL:o}),a=await n.renderToString({});return{rendererContext:n.rendererContext,renderToString:e=>{const t=s(e.event);return e.modules||=new Set,e.payload.serverRendered=!1,e.config={public:t.public,app:t.app},Promise.resolve(a)}}});function lazyCachedFunction(e){let t=null;return()=>(null===t&&(t=e().catch(e=>{throw t=null,e})),t)}const I=lazyCachedFunction(()=>import("../build/styles.mjs").then(e=>e.default||e));function renderPayloadJsonScript(e){const t={type:"application/json",innerHTML:e.data?b(e.data,e.ssrContext._payloadReducers):"","data-nuxt-data":"nuxt-app","data-ssr":!e.ssrContext.noSSR,id:"__NUXT_DATA__"};e.src&&(t["data-src"]=e.src);return[t,{innerHTML:`window.__NUXT__={};window.__NUXT__.config=${_(e.ssrContext.config)}`}]}function splitPayload(e){const{data:t,prerenderedAt:r,...n}=e.payload;return{initial:{...n,prerenderedAt:r},payload:{data:t,prerenderedAt:r}}}const J={disableDefaults:!0,disableCapoSorting:!1,plugins:[$,H,L,O]};const X={omitLineBreaks:!1};globalThis.__buildAssetsURL=o,globalThis.__publicAssetsURL=l;const q=!!M.id,B=q?`<div${y(M)}>`:"",W=q?"</div>":"",Y=/^[^?]*\/_payload.json(?:\?.*)?$/,G=d(async e=>{const d=h(),l=e.path.startsWith("/__nuxt_error")?u(e):null;if(l&&!("__unenv__"in e.node.req))throw c({statusCode:404,statusMessage:"Page Not Found: /__nuxt_error"});const f=function(e){return{url:e.path,event:e,runtimeConfig:s(e),noSSR:e.context.nuxt?.noSSR||!1,head:createHead(J),error:!1,nuxt:void 0,payload:{},_payloadReducers:Object.create(null),modules:new Set}}(e),m={mode:"server"};f.head.push(z,m),l&&(l.statusCode&&=Number.parseInt(l.statusCode),function(e,t){e.error=!0,e.payload={error:t},e.url=t.url}(f,l));const y=Y.test(f.url);if(y){const t=f.url.substring(0,f.url.lastIndexOf("/"))||"/";f.url=t,e._path=e.node.req.url=t}const _=p(e);!1===_.ssr&&(f.noSSR=!0);const w=await function(e){return e.noSSR?F():E()}(f);for(const e of await getClientManifest().then(e=>Object.values(e).filter(e=>e._globalCSS).map(e=>e.src)))f.modules.add(e);const v=await w.renderToString(f).catch(async e=>{if(f._renderResponse&&"skipping render"===e.message)return{};const t=!l&&f.payload?.error||e;throw await(f.nuxt?.hooks.callHook("app:error",t)),t}),x=f._renderResponse||y?[]:await async function(e){const t=await I(),r=new Set;for(const n of e)if(n in t&&t[n])for(const e of await t[n]())r.add(e);return Array.from(r).map(e=>({innerHTML:e}))}(f.modules??[]);if(await(f.nuxt?.hooks.callHook("app:rendered",{ssrContext:f,renderResult:v})),f._renderResponse)return f._renderResponse;if(f.payload?.error&&!l)throw f.payload.error;if(y){const e=function(e){return{body:b(splitPayload(e).payload,e._payloadReducers),statusCode:i(e.event),statusMessage:a(e.event),headers:{"content-type":"application/json;charset=utf-8","x-powered-by":"Nuxt"}}}(f);return e}const C=_.noScripts,{styles:S,scripts:j}=t(f,w.rendererContext);f._preloadManifest&&!C&&f.head.push({link:[{rel:"preload",as:"fetch",fetchpriority:"low",crossorigin:"anonymous",href:o(`builds/meta/${f.runtimeConfig.app.buildId}.json`)}]},{...m,tagPriority:"low"}),x.length&&f.head.push({style:x});const T=[];for(const e of Object.values(S))T.push({rel:"stylesheet",href:w.rendererContext.buildAssetsURL(e.file),crossorigin:""});if(T.length&&f.head.push({link:T},m),C||(f.head.push({link:r(f,w.rendererContext)},m),f.head.push({link:n(f,w.rendererContext)},m),f.head.push({script:renderPayloadJsonScript({ssrContext:f,data:f.payload})},{...m,tagPosition:"bodyClose",tagPriority:"high"})),!_.noScripts){const e="head";f.head.push({script:Object.values(j).map(t=>({type:t.module?"module":null,src:w.rendererContext.buildAssetsURL(t.file),defer:!t.module||null,tagPosition:e,crossorigin:""}))},m)}const{headTags:A,bodyTags:R,bodyTagsOpen:k,htmlAttrs:P,bodyAttrs:$}=await g(f.head,X),H={htmlAttrs:P?[P]:[],head:normalizeChunks([A]),bodyAttrs:$?[$]:[],bodyPrepend:normalizeChunks([k,f.teleports?.body]),body:[v.html,B+(q?joinTags([f.teleports?.[`#${M.id}`]]):"")+W],bodyAppend:[R]};return await d.hooks.callHook("render:html",H,{event:e}),{body:(L=H,`<!DOCTYPE html><html${joinAttrs(L.htmlAttrs)}><head>${joinTags(L.head)}</head><body${joinAttrs(L.bodyAttrs)}>${joinTags(L.bodyPrepend)}${joinTags(L.body)}${joinTags(L.bodyAppend)}</body></html>`),statusCode:i(e),statusMessage:a(e),headers:{"content-type":"text/html;charset=utf-8","x-powered-by":"Nuxt"}};var L});function normalizeChunks(e){return e.filter(Boolean).map(e=>e.trim())}function joinTags(e){return e.join("")}function joinAttrs(e){return 0===e.length?"":" "+e.join(" ")}const K=Object.freeze(Object.defineProperty({__proto__:null,default:G},Symbol.toStringTag,{value:"Module"}));export{U as h,K as r,useHead as u};
//# sourceMappingURL=renderer.mjs.map
